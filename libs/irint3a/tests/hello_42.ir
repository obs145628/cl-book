
define 257 _putchar extern

define 0 _main
  movi %1, 42
  call %0, _iprint, %1
  ret %0

define 1 _iprint_rec
  alloca %1
  store %1, %0
  load %2, %1
  movi %3, 0
  cmpeq %4, %2, %3
  br %4, Lend, Lrec

Lrec:
  load %2, %1
  movi %3, 10
  div %4, %2, %3
  mod %5, %2, %3
  call %0, _iprint_rec, %4
  movi %6, 48
  add %7, %5, %6
  call %0, _putchar, %7

Lend:
  ret %0

define 2 _iprint
  alloca %1
  store %1, %0
  load %2, %1
  movi %3, 0
  cmplt %4, %2, %3
  br %4, Lneg, Lnext

Lneg:
  sub %4, %3, %2
  call %0, _iprint_rec, %4
  jump Lend

Lnext:
  cmpeq %4, %2, %3
  br %4, Lnull, Lpos

Lnull:
  movi %4, 48
  call %0, _putchar, %4
  jump Lend

Lpos:
  call %0, _iprint_rec, %2
  jump Lend

Lend:
  ret %0