# LExpr (lanexpr)

Programming language where everything is an expression.  
The whole program is actually an expression that gets evaluated as the main function.  
Main features:
- 2 types: int32 and void
- constructs: if/else, while, sequence, scope, function definitons, variable definitions, assignment
- binary operators: +, -, *, /, %, ==, <, >
- unary operators: +, -, !
- constants, variables, function calls

# Compilation

## Parser

The parser check the code syntax and build an AST

## Typecheck

Perform semantic analysis: check if the code is correct, and generate symbol tables for all the definitions and use in the code.

## IR generation

Lower the AST into an IR representation.  
Can be converted into multiple representations:
- irint3a
- irintsm
- LLVM IR


# Runtime

The language runtime is really small

## User main function

Because the whole file is an expression, the core execution is simply an expression. 
This expression is treated as the body that what is called the user main, that gets also compiled.

## Entry function

The entry function is generated by the compiler.  
It calls the user main function, then exits with a return code of 0.

## Standard library

Ony a few native functions are avalaible in the language

### putc

``` putc(byte_val: int): void```
Write 1 byte to the standard output. Wrapper around `putchar (3)`.

### getc

``` getc(): int```
Read 1 byte from the standard input. Wrapper around `getchar (3)`.

### exit

```exit(ret_code: int): void```
Stops the program with exit status `ret_code`. Wrapper around `exit (3)`.

### fmemget

```fmemget(addr: int): int```
Read one entry from the flat memory.  
The index `addr` is checked, and the program panics for out of bounds access.

### fmemset

```fmemset(addr: int, val: int): void```
Write to one entry of the flat memory.  
The index `addr` is checked, and the program panics for out of bounds access.

### fmemcpy

```fmemcpy(dst_addr: int, src_addr: int, size: int): void```
Copy `n` entries of flat memory from `src_addr` to `dst_addr`.  
Addresses may overlap.  
The addresses are checked, and the program panics for out of bound access.
